URI-reference:
  syntax: |
    URI / relative-ref
  description: URI reference (full or relative).
URI:
  syntax: |
    scheme ":" hier-part [ "?" query ] [ "#" fragment ]
  description: Full URI (RFC3986).
absolute-URI:
  syntax: |
    scheme ":" hier-part [ "?" query ]
  description: Absolute URI (Full URI without fragment).
relative-ref:
  syntax: |
    relative-part [ "?" query ] [ "#" fragment ]
  description: Relative reference (RFC3986).
hier-part:
  syntax: |
    "//" authority path-abempty
    / path-absolute
    / path-rootless
    / path-empty
  description: Hierarchical part of URI.
relative-part:
  syntax: |
    "//" authority path-abempty
    / path-absolute
    / path-noscheme
    / path-empty
  description: Relative hierarchical part.
authority:
  syntax: |
    [ userinfo "@" ] host [ ":" port ]
  description: Authority component.
userinfo:
  syntax: |
    *( unreserved / pct-encoded / sub-delims / ":" )
  description: User information.
host:
  syntax: |
    IP-literal / IPv4address / reg-name
  description: Host component.
reg-name:
  syntax: |
    *( unreserved / pct-encoded / sub-delims )
  description: Registered name.
path:
  syntax: |
    path-abempty
    / path-absolute
    / path-noscheme
    / path-rootless
    / path-empty
  description: Path component.
path-abempty:
  syntax: |
    *( "/" segment )
  description: Zero or more "/" segment.
path-absolute:
  syntax: |
    "/" [ segment-nz *( "/" segment ) ]
  description: Absolute path.
path-noscheme:
  syntax: |
    segment-nz-nc *( "/" segment )
  description: Path without scheme.
path-rootless:
  syntax: |
    segment-nz *( "/" segment )
  description: Rootless path.
path-empty:
  syntax: |
    0<pchar>
  description: Empty path.
segment:
  syntax: |
    *pchar
  description: Path segment.
segment-nz:
  syntax: |
    1*pchar
  description: Non-zero-length segment.
segment-nz-nc:
  syntax: |
    1*( unreserved / pct-encoded / sub-delims / "@" )
  description: Non-zero-length segment without colon.
pchar:
  syntax: |
    unreserved / pct-encoded / sub-delims / ":" / "@"
  description: Path character.
query:
  syntax: |
    *( pchar / "/" / "?" )
  description: Query component.
fragment:
  syntax: |
    *( pchar / "/" / "?" )
  description: Fragment component.
IRI-reference:
  syntax: |
    IRI / irelative-ref
  description: IRI reference (full or relative).
IRI:
  syntax: |
    scheme ":" ihier-part [ "?" iquery ] [ "#" ifragment ]
  description: Top-level IRI per RFC3987.
ihier-part:
  syntax: |
    "//" iauthority ipath-abempty
    / ipath-absolute
    / ipath-rootless
    / ipath-empty
  description: Hierarchical part (authority and path) of the IRI.
absolute-IRI:
  syntax: |
    scheme ":" ihier-part [ "?" iquery ]
  description: Absolute IRI (Full IRI without fragment).
irelative-ref:
  syntax: |
    irelative-part [ "?" iquery ] [ "#" ifragment ]
  description: Relative reference (with optional query and fragment).
irelative-part:
  syntax: |
    "//" iauthority ipath-abempty
    / ipath-absolute
    / ipath-noscheme
    / ipath-empty
  description: The part of a relative reference without query or fragment.
iauthority:
  syntax: |
    [ iuserinfo "@" ] ihost [ ":" port ]
  description: 'Authority: optional userinfo, host, and optional port.'
iuserinfo:
  syntax: |
    *( iunreserved / pct-encoded / sub-delims / ":" )
  description: User info (iauthority before '@', may include percent-encoding and colon).
ihost:
  syntax: |
    IP-literal / IPv4address / ireg-name
  description: 'Host: IP-literal (IPv6/IPvFuture), IPv4 address, or internationalized name.'
ireg-name:
  syntax: |
    *( iunreserved / pct-encoded / sub-delims )
  description: Internationalized host name (allows Unicode via ucschar in iunreserved).
ipath:
  syntax: |
    ipath-abempty
    / ipath-absolute
    / ipath-noscheme
    / ipath-rootless
    / ipath-empty
  description: Path component of IRI (hierarchical).
ipath-abempty:
  syntax: |
    *( "/" isegment )
  description: Zero or more '/'-prefixed segments.
ipath-absolute:
  syntax: |
    "/" [ isegment-nz *( "/" isegment ) ]
  description: Path starting with '/', not '//' (absolute path).
ipath-noscheme:
  syntax: |
    isegment-nz-nc *( "/" isegment )
  description: Path with no scheme (first segment not empty, no colon ':').
ipath-rootless:
  syntax: |
    isegment-nz *( "/" isegment )
  description: Path beginning with a non-zero-length segment.
ipath-empty:
  syntax: |
    0<ipchar>
  description: Empty path (no characters).
isegment:
  syntax: |
    *ipchar
  description: Segment (zero or more ipchar characters).
isegment-nz:
  syntax: |
    1*ipchar
  description: Non-zero-length segment.
isegment-nz-nc:
  syntax: |
    1*( iunreserved / pct-encoded / sub-delims / "@" )
  description: Non-zero-length segment with no colon.
ipchar:
  syntax: |
    iunreserved / pct-encoded / sub-delims / ":" / "@"
  description: Character in a path segment (unreserved, pct-encoded, or delimiter).
iquery:
  syntax: |
    *( ipchar / iprivate / "/" / "?" )
  description: Query component (allows private-use characters).
ifragment:
  syntax: |
    *( ipchar / "/" / "?" )
  description: Fragment identifier component.
iunreserved:
  syntax: |
    ALPHA / DIGIT / "-" / "." / "_" / "~" / ucschar
  description: Unreserved characters (including Unicode ucschar).
ucschar:
  syntax: |
    %xA0-D7FF / %xF900-FDCF / %xFDF0-FFEF
    / %x10000-1FFFD / %x20000-2FFFD / %x30000-3FFFD
    / %x40000-4FFFD / %x50000-5FFFD / %x60000-6FFFD
    / %x70000-7FFFD / %x80000-8FFFD / %x90000-9FFFD
    / %xA0000-AFFFD / %xB0000-BFFFD / %xC0000-CFFFD
    / %xD0000-DFFFD / %xE1000-EFFFD
  description: Unicode code point ranges allowed in IRIs (excludes private-use).
iprivate:
  syntax: |
    %xE000-F8FF / %xF0000-FFFFD / %x100000-10FFFD
  description: Private-use Unicode ranges (allowed in IRI but not URI).
scheme:
  syntax: |
    ALPHA *( ALPHA / DIGIT / "+" / "-" / "." )
  description: Scheme (ASCII letters/digits) from RFC3986.
port:
  syntax: |
    *DIGIT
  description: Port number (ASCII digits).
IP-literal:
  syntax: |
    "[" ( IPv6address / IPvFuture ) "]"
  description: IP literal (IPv6 or IPvFuture) in brackets (RFC3986).
IPvFuture:
  syntax: |
    "v" 1*HEXDIG "." 1*( unreserved / sub-delims / ":" )
  description: IPvFuture address (versioned IPv6 form, per RFC3986).
IPv6address:
  syntax: |
    ''
                                 6( h16 ":" ) ls32
    /                       "::" 5( h16 ":" ) ls32
    /               [ h16 ] "::" 4( h16 ":" ) ls32
    / [ *1( h16 ":" ) h16 ] "::" 3( h16 ":" ) ls32
    / [ *2( h16 ":" ) h16 ] "::" 2( h16 ":" ) ls32
    / [ *3( h16 ":" ) h16 ] "::"    h16 ":"   ls32
    / [ *4( h16 ":" ) h16 ] "::"              ls32
    / [ *5( h16 ":" ) h16 ] "::"    h16
    / [ *6( h16 ":" ) h16 ] "::"
  description: IPv6 address (full forms from RFC3986).
h16:
  syntax: |
    1*4HEXDIG
  description: 1 to 4 hexadecimal digits (16-bit part).
ls32:
  syntax: |
    ( h16 ":" h16 ) / IPv4address
  description: Least-significant 32 bits of IPv6 (two h16 or an IPv4).
IPv4address:
  syntax: |
    dec-octet "." dec-octet "." dec-octet "." dec-octet
  description: IPv4 address (decimal dotted-quad).
dec-octet:
  syntax: |
    DIGIT
    / %x31-39 DIGIT
    / "1" 2DIGIT
    / "2" %x30-34 DIGIT
    / "25" %x30-35
  description: Decimal octet (0-255) for IPv4 (from RFC3986).
pct-encoded:
  syntax: |
    "%" HEXDIG HEXDIG
  description: Percent-encoded octet (hexadecimal encoding).
unreserved:
  syntax: |
    ALPHA / DIGIT / "-" / "." / "_" / "~"
  description: Unreserved ASCII characters (RFC3986).
reserved:
  syntax: |
    gen-delims / sub-delims
  description: Reserved characters (RFC3986).
gen-delims:
  syntax: |
    ":" / "/" / "?" / "#" / "[" / "]" / "@"
  description: General delimiters (RFC3986).
sub-delims:
  syntax: |
    "!" / "&" / "$" / "'" / "(" / ")"
    / "*" / "+" / "," / ";" / "="
  description: Subcomponent delimiters (RFC3986).
ALPHA:
  syntax: |
    %x41-5A / %x61-7A
  description: ASCII letters A-Z / a-z (RFC5234).
DIGIT:
  syntax: |
    %x30-39
  description: ASCII digits 0-9 (RFC5234).
HEXDIG:
  syntax: |
    DIGIT / %x41-46 / %x61-66
  description: Hexadecimal digits (0-9, A-F, a-f) (RFC5234).
